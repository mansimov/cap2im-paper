\section{Training Details}
\label{sec:training_details}

\subsection{Hyperparameters}

Each parameter in alignDRAW was initialized by sampling from the Gaussian distribution of mean $0$ and standard deviation of $0.01$. The model was trained using \textit{RMSprop} with initial learning rate of $0.001$. The norm of the gradients was clipped to $10.0$ during training to deal with exploding gradients. For all tasks, $\overrightarrow{h}^{lang}_{n}$ and $\overleftarrow{h}^{lang}_{n}$ in the language model had $128$ units, and vector $v$ in \textit{align} perceptron had $512$ units. For the Microsoft COCO task, the alignDRAW model was trained for $18$ epochs and the learning rate was reduced by the factor of $0.1$ after $11$ epochs. The architectural configurations of alignDRAW models are shown on Table~\ref{tab:drawhyper}.

\begin{table}[!h]
\begin{center}
\begin{tabulary}{\linewidth}{c | c c c c c c}
\hline
\multicolumn{7}{c}{\textbf{alignDRAW Model}} \\
\hline
Task & \#glimpses & Inference \#$h$ & Generative \#$h$ & \#$z$ & Read Size & Write Size\\
\hline
Microsoft COCO & 32 & 550 & 550 & 275 & 9 & 9\\
MNIST Captions & 32 & 300 & 300 & 150 & 8 & 8\\
\end{tabulary}
\caption{The architectural configurations of alignDRAW models.}
\label{tab:drawhyper}
\end{center}
%\vspace{-0.3cm}
\end{table}

The GAN model used for sharpening had the same configuration as the $28 \times 28$ model trained by \cite{denton_lapgan} on the edge residuals of CIFAR dataset. The configuration can be found at \url{https://gist.github.com/soumith/e3f722173ea16c1ea0d9}. The model was trained for $6$ epochs.

\subsection{Evaluation}

On Table~\ref{tab:nll}, you can see that the alignDRAW model didn't overfit on the training data as well as managed to achieve a better lower bound of log likelihood on the test data. Also notice that, the results worsened dramatically after sharpening test images.

\begin{table}[!h]
\begin{center}
\begin{tabulary}{\linewidth}{c | c c c c}
\hline
Model & Train LL & Valid LL & Test LL & Test LL (after sharpening)\\
\hline
skipthoughtDRAW & -1794.29 & -1797.41 & -1791.37 & -2045.84 \\
noalignDRAW & -1792.14 & -1796.94 & -1791.15 & -2051.07 \\
alignDRAW & -1792.15 & -1797.24 & -1791.53 & -2042.31
\end{tabulary}
\caption{The lower bound of log likelihood of conditional DRAW models on the Microsoft COCO.}
\label{tab:nll}
\end{center}
\end{table}